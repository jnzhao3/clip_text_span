WARNING:root:Images sizes do not match. This will causes images to be display incorrectly in the UI.
/home/eecs/shuoyuan/proj/clip_text_span/finetune/zero-shot.py:62: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.no_grad(), torch.cuda.amp.autocast():
/home/eecs/shuoyuan/miniconda3/envs/prsclip/lib/python3.12/site-packages/torch/amp/autocast_mode.py:266: UserWarning: User provided device_type of 'cuda', but CUDA is not available. Disabling
  warnings.warn(
100%|██████████████████████████████████████████████████| 1000/1000 [01:07<00:00, 14.76it/s]
Incorrectly Predicted: rock beauty fish, Actual: tench, Probability: 0.7724
Top 5 Predictions: ['rock beauty fish', 'snoek fish', 'gar fish', 'silver salmon', 'tench']
Incorrectly Predicted: rock beauty fish, Actual: tench, Probability: 0.6468
Top 5 Predictions: ['rock beauty fish', 'gar fish', 'snoek fish', 'silver salmon', 'tench']
Incorrectly Predicted: trench coat, Actual: tench, Probability: 0.3323
Top 5 Predictions: ['trench coat', 'comic book', 'apiary', 'sea anemone', 'poke bonnet']
Incorrectly Predicted: silver salmon, Actual: tench, Probability: 0.8944
Top 5 Predictions: ['silver salmon', 'gar fish', 'sturgeon', 'snoek fish', 'rock beauty fish']
Incorrectly Predicted: rock beauty fish, Actual: tench, Probability: 0.3870
Top 5 Predictions: ['rock beauty fish', 'silver salmon', 'gar fish', 'snoek fish', 'tench']
Incorrectly Predicted: snoek fish, Actual: tench, Probability: 0.4412
Top 5 Predictions: ['snoek fish', 'silver salmon', 'gar fish', 'tench', 'rock beauty fish']
Incorrectly Predicted: sturgeon, Actual: tench, Probability: 0.5469
Top 5 Predictions: ['sturgeon', 'snoek fish', 'gar fish', 'eel', 'tench']
Incorrectly Predicted: snoek fish, Actual: tench, Probability: 0.2608
Top 5 Predictions: ['snoek fish', 'tench', 'rock beauty fish', 'gar fish', 'terrapin']
Incorrectly Predicted: goldfish, Actual: tench, Probability: 0.4480
Top 5 Predictions: ['goldfish', 'rock beauty fish', 'gar fish', 'snoek fish', 'tench']
Incorrectly Predicted: silver salmon, Actual: tench, Probability: 0.3845
Top 5 Predictions: ['silver salmon', 'gar fish', 'sturgeon', 'snoek fish', 'tench']
Incorrectly Predicted: snoek fish, Actual: tench, Probability: 0.4276
Top 5 Predictions: ['snoek fish', 'tench', 'gar fish', 'silver salmon', 'rock beauty fish']
Incorrectly Predicted: gyromitra, Actual: tench, Probability: 0.3702
Top 5 Predictions: ['gyromitra', 'goldfish', 'tench', 'gar fish', 'snoek fish']
Incorrectly Predicted: gar fish, Actual: tench, Probability: 0.8170
Top 5 Predictions: ['gar fish', 'sturgeon', 'snoek fish', 'goldfish', 'tench']
Incorrectly Predicted: dugong, Actual: tench, Probability: 0.5086
Top 5 Predictions: ['dugong', 'silver salmon', 'tench', 'snoek fish', 'gar fish']
Incorrectly Predicted: rock beauty fish, Actual: tench, Probability: 0.3058
Top 5 Predictions: ['rock beauty fish', 'snoek fish', 'gar fish', 'lakeshore', 'tench']
Incorrectly Predicted: rock beauty fish, Actual: tench, Probability: 0.7269
Top 5 Predictions: ['rock beauty fish', 'snoek fish', 'gar fish', 'silver salmon', 'tench']
Incorrectly Predicted: snoek fish, Actual: tench, Probability: 0.4812
Top 5 Predictions: ['snoek fish', 'silver salmon', 'tench', 'gar fish', 'rock beauty fish']
Incorrectly Predicted: gar fish, Actual: tench, Probability: 0.4147
Top 5 Predictions: ['gar fish', 'snoek fish', 'tench', 'rock beauty fish', 'goldfish']
Incorrectly Predicted: gar fish, Actual: tench, Probability: 0.5215
Top 5 Predictions: ['gar fish', 'snoek fish', 'tench', 'sturgeon', 'rock beauty fish']
Incorrectly Predicted: fishing casting reel, Actual: goldfish, Probability: 0.6542
Top 5 Predictions: ['fishing casting reel', 'goldfish', 'snoek fish', 'snorkel', 'gar fish']
Incorrectly Predicted: rock beauty fish, Actual: goldfish, Probability: 0.6482
Top 5 Predictions: ['rock beauty fish', 'goldfish', 'snoek fish', 'gar fish', 'axolotl']
Incorrectly Predicted: tench, Actual: goldfish, Probability: 0.2810
Top 5 Predictions: ['tench', 'snoek fish', 'gar fish', 'goldfish', 'sturgeon']
Incorrectly Predicted: hammerhead shark, Actual: great white shark, Probability: 0.5343
Top 5 Predictions: ['hammerhead shark', 'great white shark', 'tiger shark', 'muzzle', 'sturgeon']
Incorrectly Predicted: hammerhead shark, Actual: great white shark, Probability: 0.6469
Top 5 Predictions: ['hammerhead shark', 'tiger shark', 'great white shark', 'sturgeon', 'gar fish']
Incorrectly Predicted: hammerhead shark, Actual: great white shark, Probability: 0.7767
Top 5 Predictions: ['hammerhead shark', 'great white shark', 'tiger shark', 'sturgeon', 'killer whale']
Incorrectly Predicted: hammerhead shark, Actual: great white shark, Probability: 0.8722
Top 5 Predictions: ['hammerhead shark', 'tiger shark', 'great white shark', 'stingray', 'gar fish']
Incorrectly Predicted: website, Actual: great white shark, Probability: 0.0127
Top 5 Predictions: ['website', 'lacewing', 'dowitcher', 'geyser', 'mop']
Incorrectly Predicted: hammerhead shark, Actual: great white shark, Probability: 0.4976
Top 5 Predictions: ['hammerhead shark', 'great white shark', 'tiger shark', 'sturgeon', 'stingray']
Incorrectly Predicted: tiger shark, Actual: great white shark, Probability: 0.4500
Top 5 Predictions: ['tiger shark', 'great white shark', 'hammerhead shark', 'sturgeon', 'gar fish']
Incorrectly Predicted: tiger shark, Actual: great white shark, Probability: 0.4737
Top 5 Predictions: ['tiger shark', 'great white shark', 'hammerhead shark', 'sturgeon', 'gar fish']
Incorrectly Predicted: hammerhead shark, Actual: great white shark, Probability: 0.6691
Top 5 Predictions: ['hammerhead shark', 'great white shark', 'tiger shark', 'sturgeon', 'gar fish']
Incorrectly Predicted: hammerhead shark, Actual: great white shark, Probability: 0.5486
Top 5 Predictions: ['hammerhead shark', 'tiger shark', 'sturgeon', 'great white shark', 'gar fish']
Incorrectly Predicted: dugong, Actual: great white shark, Probability: 0.8119
Top 5 Predictions: ['dugong', 'stingray', 'axolotl', 'electric ray', 'sturgeon']
Incorrectly Predicted: hammerhead shark, Actual: great white shark, Probability: 0.5106
Top 5 Predictions: ['hammerhead shark', 'great white shark', 'tiger shark', 'sturgeon', 'killer whale']
Incorrectly Predicted: sturgeon, Actual: great white shark, Probability: 0.4539
Top 5 Predictions: ['sturgeon', 'gar fish', 'dugong', 'tiger shark', 'snoek fish']
Incorrectly Predicted: tiger shark, Actual: great white shark, Probability: 0.4622
Top 5 Predictions: ['tiger shark', 'hammerhead shark', 'great white shark', 'sturgeon', 'gar fish']
Incorrectly Predicted: hammerhead shark, Actual: great white shark, Probability: 0.7329
Top 5 Predictions: ['hammerhead shark', 'sturgeon', 'tiger shark', 'gar fish', 'great white shark']
Incorrectly Predicted: tiger shark, Actual: great white shark, Probability: 0.5148
Top 5 Predictions: ['tiger shark', 'great white shark', 'hammerhead shark', 'sturgeon', 'gar fish']
Incorrectly Predicted: hammerhead shark, Actual: great white shark, Probability: 0.5271
Top 5 Predictions: ['hammerhead shark', 'great white shark', 'bath towel', 'tiger shark', 'killer whale']
Incorrectly Predicted: hammerhead shark, Actual: great white shark, Probability: 0.5785
Top 5 Predictions: ['hammerhead shark', 'great white shark', 'tiger shark', 'sturgeon', 'gar fish']
Incorrectly Predicted: sturgeon, Actual: great white shark, Probability: 0.4280
Top 5 Predictions: ['sturgeon', 'tiger shark', 'silver salmon', 'hammerhead shark', 'stingray']
Incorrectly Predicted: tiger shark, Actual: great white shark, Probability: 0.7233
Top 5 Predictions: ['tiger shark', 'great white shark', 'hammerhead shark', 'sturgeon', 'gar fish']
Incorrectly Predicted: tench, Actual: great white shark, Probability: 0.1614
Top 5 Predictions: ['tench', 'knot', 'axolotl', 'sturgeon', 'eel']
Incorrectly Predicted: tiger shark, Actual: great white shark, Probability: 0.5461
Top 5 Predictions: ['tiger shark', 'great white shark', 'hammerhead shark', 'sturgeon', 'gyromitra']
Incorrectly Predicted: tiger shark, Actual: great white shark, Probability: 0.4406
Top 5 Predictions: ['tiger shark', 'hammerhead shark', 'great white shark', 'sturgeon', 'gar fish']
Incorrectly Predicted: great white shark, Actual: tiger shark, Probability: 0.7586
Top 5 Predictions: ['great white shark', 'hammerhead shark', 'tiger shark', 'sturgeon', 'gar fish']
Incorrectly Predicted: hammerhead shark, Actual: tiger shark, Probability: 0.4497
Top 5 Predictions: ['hammerhead shark', 'great white shark', 'tiger shark', 'sturgeon', 'killer whale']
Incorrectly Predicted: snoek fish, Actual: tiger shark, Probability: 0.4884
Top 5 Predictions: ['snoek fish', 'tench', 'hook', 'gar fish', 'eel']
Incorrectly Predicted: hammerhead shark, Actual: tiger shark, Probability: 0.2859
Top 5 Predictions: ['hammerhead shark', 'gar fish', 'great white shark', 'tiger shark', 'sturgeon']
Incorrectly Predicted: sturgeon, Actual: tiger shark, Probability: 0.5558
Top 5 Predictions: ['sturgeon', 'hammerhead shark', 'tiger shark', 'gar fish', 'great white shark']
Incorrectly Predicted: great white shark, Actual: tiger shark, Probability: 0.5274
Top 5 Predictions: ['great white shark', 'tiger shark', 'hammerhead shark', 'sturgeon', 'killer whale']
Incorrectly Predicted: great white shark, Actual: tiger shark, Probability: 0.5055
Top 5 Predictions: ['great white shark', 'tiger shark', 'hammerhead shark', 'sturgeon', 'killer whale']
Incorrectly Predicted: sturgeon, Actual: tiger shark, Probability: 0.6044
Top 5 Predictions: ['sturgeon', 'gar fish', 'hammerhead shark', 'snoek fish', 'tiger shark']
Incorrectly Predicted: great white shark, Actual: tiger shark, Probability: 0.3710
Top 5 Predictions: ['great white shark', 'tiger shark', 'hammerhead shark', 'sturgeon', 'gar fish']
Incorrectly Predicted: sturgeon, Actual: tiger shark, Probability: 0.4157
Top 5 Predictions: ['sturgeon', 'snoek fish', 'gar fish', 'newt', 'smooth newt']
Incorrectly Predicted: great white shark, Actual: tiger shark, Probability: 0.4593
Top 5 Predictions: ['great white shark', 'hammerhead shark', 'tiger shark', 'sturgeon', 'muzzle']
Incorrectly Predicted: great white shark, Actual: tiger shark, Probability: 0.6833
Top 5 Predictions: ['great white shark', 'tiger shark', 'hammerhead shark', 'sturgeon', 'killer whale']
Incorrectly Predicted: great white shark, Actual: tiger shark, Probability: 0.4373
Top 5 Predictions: ['great white shark', 'hammerhead shark', 'tiger shark', 'sturgeon', 'killer whale']
Incorrectly Predicted: sturgeon, Actual: tiger shark, Probability: 0.7945
Top 5 Predictions: ['sturgeon', 'tiger shark', 'gar fish', 'hammerhead shark', 'great white shark']
Incorrectly Predicted: sturgeon, Actual: tiger shark, Probability: 0.4944
Top 5 Predictions: ['sturgeon', 'tiger shark', 'gar fish', 'silver salmon', 'snoek fish']
Incorrectly Predicted: sturgeon, Actual: tiger shark, Probability: 0.7464
Top 5 Predictions: ['sturgeon', 'gar fish', 'snoek fish', 'hammerhead shark', 'tiger shark']
Incorrectly Predicted: hammerhead shark, Actual: tiger shark, Probability: 0.4582
Top 5 Predictions: ['hammerhead shark', 'tiger shark', 'great white shark', 'sturgeon', 'gar fish']
Incorrectly Predicted: great white shark, Actual: tiger shark, Probability: 0.6593
Top 5 Predictions: ['great white shark', 'hammerhead shark', 'tiger shark', 'sturgeon', 'killer whale']
Incorrectly Predicted: great white shark, Actual: tiger shark, Probability: 0.5178
Top 5 Predictions: ['great white shark', 'tiger shark', 'hammerhead shark', 'sturgeon', 'dugong']
Incorrectly Predicted: sturgeon, Actual: tiger shark, Probability: 0.4680
Top 5 Predictions: ['sturgeon', 'snoek fish', 'gar fish', 'newt', 'hammerhead shark']
Incorrectly Predicted: pillow, Actual: tiger shark, Probability: 0.6689
Top 5 Predictions: ['pillow', 'great white shark', 'tiger shark', 'hammerhead shark', 'killer whale']
Incorrectly Predicted: sturgeon, Actual: tiger shark, Probability: 0.5973
Top 5 Predictions: ['sturgeon', 'tiger shark', 'gar fish', 'hammerhead shark', 'dugong']
Incorrectly Predicted: sturgeon, Actual: tiger shark, Probability: 0.3617
Top 5 Predictions: ['sturgeon', 'hammerhead shark', 'gar fish', 'snoek fish', 'tiger shark']
Incorrectly Predicted: sturgeon, Actual: tiger shark, Probability: 0.6602
Top 5 Predictions: ['sturgeon', 'tiger shark', 'hammerhead shark', 'gar fish', 'great white shark']
Incorrectly Predicted: killer whale, Actual: hammerhead shark, Probability: 0.5782
Top 5 Predictions: ['killer whale', 'great white shark', 'grey whale', 'hammerhead shark', 'sturgeon']
Incorrectly Predicted: great white shark, Actual: hammerhead shark, Probability: 0.6222
Top 5 Predictions: ['great white shark', 'hammerhead shark', 'tiger shark', 'sturgeon', 'stingray']
Incorrectly Predicted: great white shark, Actual: hammerhead shark, Probability: 0.5192
Top 5 Predictions: ['great white shark', 'hammerhead shark', 'tiger shark', 'sturgeon', 'stingray']
Incorrectly Predicted: chiton, Actual: electric ray, Probability: 0.6939
Top 5 Predictions: ['chiton', 'electric ray', 'gyromitra', 'sea cucumber', 'flatworm']
Incorrectly Predicted: stingray, Actual: electric ray, Probability: 0.8992
Top 5 Predictions: ['stingray', 'electric ray', 'sea slug', 'snoek fish', 'slug']
Incorrectly Predicted: stingray, Actual: electric ray, Probability: 0.6075
Top 5 Predictions: ['stingray', 'electric ray', 'gyromitra', 'chiton', 'sea slug']
Incorrectly Predicted: gyromitra, Actual: electric ray, Probability: 0.4256
Top 5 Predictions: ['gyromitra', 'isopod', 'trilobite', 'chiton', 'sea slug']
Incorrectly Predicted: stingray, Actual: electric ray, Probability: 0.9329
Top 5 Predictions: ['stingray', 'electric ray', 'sea slug', 'chiton', 'gyromitra']
Incorrectly Predicted: stingray, Actual: electric ray, Probability: 0.6538
Top 5 Predictions: ['stingray', 'electric ray', 'sea slug', 'slug', 'sea cucumber']
Incorrectly Predicted: stingray, Actual: electric ray, Probability: 0.6476
Top 5 Predictions: ['stingray', 'electric ray', 'poke bonnet', 'sea slug', 'swimming cap']
Incorrectly Predicted: stingray, Actual: electric ray, Probability: 0.8358
Top 5 Predictions: ['stingray', 'electric ray', 'gyromitra', 'chiton', 'flatworm']
Incorrectly Predicted: stingray, Actual: electric ray, Probability: 0.9039
Top 5 Predictions: ['stingray', 'electric ray', 'sea slug', 'gyromitra', 'slug']
Incorrectly Predicted: stingray, Actual: electric ray, Probability: 0.5509
Top 5 Predictions: ['stingray', 'electric ray', 'sea slug', 'gyromitra', 'snoek fish']
Incorrectly Predicted: stingray, Actual: electric ray, Probability: 0.7656
Top 5 Predictions: ['stingray', 'electric ray', 'gyromitra', 'sea slug', 'chiton']
Incorrectly Predicted: snoek fish, Actual: electric ray, Probability: 0.5741
Top 5 Predictions: ['snoek fish', 'silver salmon', 'eel', 'sturgeon', 'gar fish']
Incorrectly Predicted: stingray, Actual: electric ray, Probability: 0.9377
Top 5 Predictions: ['stingray', 'electric ray', 'gyromitra', 'sea slug', 'snoek fish']
Incorrectly Predicted: stingray, Actual: electric ray, Probability: 0.3828
Top 5 Predictions: ['stingray', 'electric ray', 'chiton', 'gyromitra', 'sea cucumber']
Incorrectly Predicted: stingray, Actual: electric ray, Probability: 0.6593
Top 5 Predictions: ['stingray', 'electric ray', 'sea slug', 'gyromitra', 'flatworm']
Incorrectly Predicted: gyromitra, Actual: electric ray, Probability: 0.4932
Top 5 Predictions: ['gyromitra', 'slug', 'sea slug', 'chiton', 'stingray']
Incorrectly Predicted: chiton, Actual: electric ray, Probability: 0.6748
Top 5 Predictions: ['chiton', 'gyromitra', 'muzzle', 'nematode', 'ant']
Incorrectly Predicted: stingray, Actual: electric ray, Probability: 0.8617
Top 5 Predictions: ['stingray', 'electric ray', 'conch', 'sea slug', 'hammerhead shark']
Incorrectly Predicted: stingray, Actual: electric ray, Probability: 0.5113
Top 5 Predictions: ['stingray', 'electric ray', 'sea slug', 'snoek fish', 'newt']
Incorrectly Predicted: stingray, Actual: electric ray, Probability: 0.8042
Top 5 Predictions: ['stingray', 'sea slug', 'electric ray', 'slug', 'snoek fish']
Incorrectly Predicted: snoek fish, Actual: electric ray, Probability: 0.7674
Top 5 Predictions: ['snoek fish', 'silver salmon', 'eel', 'gar fish', 'tench']
Incorrectly Predicted: stingray, Actual: electric ray, Probability: 0.8081
Top 5 Predictions: ['stingray', 'electric ray', 'gyromitra', 'flatworm', 'sea slug']
Incorrectly Predicted: stingray, Actual: electric ray, Probability: 0.7868
Top 5 Predictions: ['stingray', 'electric ray', 'gyromitra', 'flatworm', 'sea slug']
Incorrectly Predicted: fig, Actual: electric ray, Probability: 0.2795
Top 5 Predictions: ['fig', 'pufferfish', 'gyromitra', 'electric ray', 'pomegranate']
Incorrectly Predicted: stingray, Actual: electric ray, Probability: 0.7018
Top 5 Predictions: ['stingray', 'electric ray', 'snoek fish', 'sea slug', 'gyromitra']
Incorrectly Predicted: fig, Actual: electric ray, Probability: 0.1561
Top 5 Predictions: ['fig', 'acorn', 'sea slug', 'slug', 'flatworm']
Incorrectly Predicted: stingray, Actual: electric ray, Probability: 0.7973
Top 5 Predictions: ['stingray', 'electric ray', 'gyromitra', 'flatworm', 'snoek fish']
Incorrectly Predicted: stingray, Actual: electric ray, Probability: 0.7195
Top 5 Predictions: ['stingray', 'electric ray', 'gyromitra', 'chiton', 'fig']
Incorrectly Predicted: chiton, Actual: electric ray, Probability: 0.1839
Top 5 Predictions: ['chiton', 'stingray', 'sea slug', 'gyromitra', 'dugong']
Incorrectly Predicted: stingray, Actual: electric ray, Probability: 0.9110
Top 5 Predictions: ['stingray', 'electric ray', 'gyromitra', 'sea slug', 'chiton']
Incorrectly Predicted: stingray, Actual: electric ray, Probability: 0.6400
Top 5 Predictions: ['stingray', 'electric ray', 'sea slug', 'sea cucumber', 'slug']
Incorrectly Predicted: stingray, Actual: electric ray, Probability: 0.6405
Top 5 Predictions: ['stingray', 'electric ray', 'poke bonnet', 'conch', 'sea slug']
Incorrectly Predicted: stingray, Actual: electric ray, Probability: 0.7917
Top 5 Predictions: ['stingray', 'electric ray', 'gyromitra', 'chiton', 'sea slug']
Incorrectly Predicted: stingray, Actual: electric ray, Probability: 0.9043
Top 5 Predictions: ['stingray', 'electric ray', 'sea slug', 'gyromitra', 'slug']
Incorrectly Predicted: stingray, Actual: electric ray, Probability: 0.6017
Top 5 Predictions: ['stingray', 'electric ray', 'sea slug', 'gyromitra', 'snoek fish']
Incorrectly Predicted: stingray, Actual: electric ray, Probability: 0.7066
Top 5 Predictions: ['stingray', 'electric ray', 'gyromitra', 'sea slug', 'chiton']
Incorrectly Predicted: stingray, Actual: electric ray, Probability: 0.9432
Top 5 Predictions: ['stingray', 'electric ray', 'gyromitra', 'sea slug', 'snoek fish']
Incorrectly Predicted: stingray, Actual: electric ray, Probability: 0.3821
Top 5 Predictions: ['stingray', 'gyromitra', 'electric ray', 'slug', 'sea slug']
Incorrectly Predicted: stingray, Actual: electric ray, Probability: 0.6793
Top 5 Predictions: ['stingray', 'electric ray', 'snoek fish', 'sea slug', 'gyromitra']
Incorrectly Predicted: knot, Actual: electric ray, Probability: 0.4540
Top 5 Predictions: ['knot', 'sea slug', 'fig', 'flatworm', 'slug']
Incorrectly Predicted: stingray, Actual: electric ray, Probability: 0.7672
Top 5 Predictions: ['stingray', 'electric ray', 'gyromitra', 'flatworm', 'sea slug']
Incorrectly Predicted: electric ray, Actual: stingray, Probability: 0.8054
Top 5 Predictions: ['electric ray', 'purse', 'stingray', 'poke bonnet', 'handkerchief']
Traceback (most recent call last):
  File "/home/eecs/shuoyuan/proj/clip_text_span/finetune/zero-shot.py", line 80, in <module>
    image_features = model.encode_image(image)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/eecs/shuoyuan/miniconda3/envs/prsclip/lib/python3.12/site-packages/open_clip/model.py", line 279, in encode_image
    features = self.visual(image)
               ^^^^^^^^^^^^^^^^^^
  File "/home/eecs/shuoyuan/miniconda3/envs/prsclip/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/eecs/shuoyuan/miniconda3/envs/prsclip/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/eecs/shuoyuan/miniconda3/envs/prsclip/lib/python3.12/site-packages/open_clip/transformer.py", line 827, in forward
    x = self.transformer(x)
        ^^^^^^^^^^^^^^^^^^^
  File "/home/eecs/shuoyuan/miniconda3/envs/prsclip/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/eecs/shuoyuan/miniconda3/envs/prsclip/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/eecs/shuoyuan/miniconda3/envs/prsclip/lib/python3.12/site-packages/open_clip/transformer.py", line 504, in forward
    x = r(x, attn_mask=attn_mask)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/eecs/shuoyuan/miniconda3/envs/prsclip/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/eecs/shuoyuan/miniconda3/envs/prsclip/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/eecs/shuoyuan/miniconda3/envs/prsclip/lib/python3.12/site-packages/open_clip/transformer.py", line 266, in forward
    x = q_x + self.ls_1(self.attention(q_x=self.ln_1(q_x), k_x=k_x, v_x=v_x, attn_mask=attn_mask))
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/eecs/shuoyuan/miniconda3/envs/prsclip/lib/python3.12/site-packages/open_clip/transformer.py", line 253, in attention
    return self.attn(
           ^^^^^^^^^^
  File "/home/eecs/shuoyuan/miniconda3/envs/prsclip/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/eecs/shuoyuan/miniconda3/envs/prsclip/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/eecs/shuoyuan/miniconda3/envs/prsclip/lib/python3.12/site-packages/torch/nn/modules/activation.py", line 1373, in forward
    attn_output, attn_output_weights = F.multi_head_attention_forward(
                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/eecs/shuoyuan/miniconda3/envs/prsclip/lib/python3.12/site-packages/torch/nn/functional.py", line 6230, in multi_head_attention_forward
    q, k, v = _in_projection_packed(query, key, value, in_proj_weight, in_proj_bias)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/eecs/shuoyuan/miniconda3/envs/prsclip/lib/python3.12/site-packages/torch/nn/functional.py", line 5614, in _in_projection_packed
    proj = linear(q, w, b)
           ^^^^^^^^^^^^^^^
KeyboardInterrupt
